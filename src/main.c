/*

Program Description: A game (Royal Riches) where a princess catches falling coins with features that include;
					 a timer, music/sound, LEDs, buttons, serial port connection (remote control), lives(with animation), score, ability to restart, game over page, welcome page. 

Authors: Mera Saoud, Amanda Ajredini, Eman Abdelatti

Date: 20/02/2024

*/

// Header Files
#include <stm32f031x6.h>
#include "display.h"// Header to access functions that we need to display 
#include "musical_notes.h"// Header to access music notes
#include "sound.h"// Header to access the functions needed for music and sound
#include "serial.h" // For use of functions for serial connection
#include <time.h> // For use in random numbers
#include <stdlib.h>	// For use in random numbers
#include <stdbool.h> // For use of bool variables																																										

// Symbolic Name(s)
#define SCREEN_WIDTH 128
#define SCREEN_HEIGHT 160

// Function Signatures
void initClock(void);// This function initializes the clock system by configuring the PLL to generate a clock signal with a specific multiplier
void initSysTick(void);// This function initializes the SysTick timer, configures it to generate interrupts, sets an initial value for the timer, and enables interrupts globally.
void SysTick_Handler(void);// The function is designed to handle SysTick interrupts, update the state of a musical tune being played, and increment a milliseconds counter.
void delay(volatile uint32_t dly);// Delay function
void setupIO();// This function is configuring the microcontroller's GPIO pins
int isInside(uint16_t x1, uint16_t y1, uint16_t w, uint16_t h, uint16_t px, uint16_t py);// This function provides a simple way to check if a given point is inside a rectangle
void enablePullUp(GPIO_TypeDef *Port, uint32_t BitNumber);// This function is designed to enable the pull-up resistor for a specific GPIO pin
void pinMode(GPIO_TypeDef *Port, uint32_t BitNumber, uint32_t Mode);// This function is responsible for setting the mode of a specific GPIO pin on a microcontroller

void playTune(uint32_t * the_notes, uint32_t * the_times, int length, int repeat);// Function to play the song  
int RightPressed(void);// Function for pressing the right button
int RightNotPressed(void);// Function for if the right button isn't pressed																																																																																																															
int LeftPressed(void);// Function for pressing the left button
int LeftNotPressed(void);// Function for if the left button isn't pressed
void mainmenu(void);// Function for main menu
void background(void);// Function for background creation
void gameOver(void);// Function for game over menu
void gameOverFlash(void);// Function to make lights flash when game is over
void restart(void);// Function for restart menu
void livescore(int);// Function for controlling the lives and LEDs	

void redOn(void);// Function for turning on red light 1
void redOff(void);// Function for turning off red light 1
void red2On(void);// Function for turning on red light 2
void red2Off(void);// Function for turning off red light 2
void red3On(void);// Function for turning on red light 3
void red3Off(void);// Function for turning off red light 3 

// Global Variables
volatile uint32_t milliseconds;
volatile uint32_t countdown_seconds = 46;
bool gameStarted = false; // This variable is used as a flag for when the timer should start
volatile int lives = 3;
volatile int score = 0;
const uint32_t max = 116; // This is the max x value ob1x can take when spawning

// All to do with background music
uint32_t *notes;
uint32_t *note_times;
volatile int tune_playing = 1;
volatile int tune_length = 62;
volatile int tune_index = 0;
volatile int tune_time_remaining = 0;
volatile int tune_repeat = 0;


// Sprite of Princess (stationary)
const uint16_t princess[]=
{
	1533,1533,0,24327,0,24327,0,24327,0,1533,1533,1533,1533,1533,0,43507,24327,40224,24327,43507,0,1533,1533,1533,1533,1533,0,24334,24334,24334,24334,24334,0,0,1533,1533,1533,0,0,24334,0,23677,23677,24334,24334,0,1533,1533,1533,0,24334,0,23677,23677,0,23677,0,1533,1533,1533,1533,0,24334,0,23677,23677,23677,23677,0,1533,1533,1533,1533,0,24334,24334,43507,23677,23677,32693,0,1533,1533,1533,1533,24334,24334,24334,24334,0,7620,0,1533,1533,1533,1533,1533,24334,24334,24334,0,7620,7620,7620,0,1533,1533,1533,1533,24334,24334,24334,0,0,23677,0,0,1533,1533,1533,1533,24334,24334,0,0,0,23677,0,0,0,1533,1533,1533,24334,24334,0,55953,0,65535,0,55953,0,1533,1533,1533,24334,0,0,55953,0,65535,0,55953,0,1533,1533,1533,0,0,55953,56755,0,0,0,15539,55953,0,1533,1533,0,55953,56755,40644,40644,40644,40644,7620,55953,0,1533,1533,55953,56755,56755,56755,56755,56755,40644,7620,7620,55953,1533,
};

// Sprite of Princess (Walking)
const uint16_t princessWalk[]= 
{
	1533,1533,0,24327,0,24327,0,24327,0,1533,1533,1533,1533,1533,0,43507,24327,40224,24327,43507,0,1533,1533,1533,1533,1533,0,24334,24334,24334,24334,24334,0,0,1533,1533,1533,0,0,24334,0,23677,23677,24334,24334,0,1533,1533,1533,0,24334,0,23677,23677,0,23677,0,1533,1533,1533,1533,0,24334,0,23677,23677,23677,23677,0,1533,1533,1533,1533,0,24334,24334,43507,23677,23677,32693,0,1533,1533,1533,1533,24334,24334,24334,24334,0,7620,0,1533,1533,1533,1533,1533,24334,24334,24334,0,7620,7620,7620,0,1533,1533,1533,1533,24334,24334,24334,0,0,23677,0,0,0,0,1533,1533,24334,24334,0,0,0,23677,23677,65535,65535,0,1533,1533,24334,24334,0,55953,0,0,0,0,0,0,1533,1533,24334,0,0,55953,40644,7620,55953,0,0,1533,1533,1533,0,0,55953,56755,7620,7620,7620,55953,0,0,1533,1533,0,55953,56755,40644,7620,7620,7620,7620,55953,0,1533,1533,55953,56755,56755,56755,56755,56755,40644,7620,7620,55953,1533,
};

// Sprite of Coin
const uint16_t coin[]=
{
	1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,24324,24324,24324,24324,24324,24324,1533,1533,1533,1533,1533,24324,24327,24327,24327,24327,24327,24327,24324,1533,1533,1533,24324,24327,24327,24327,24327,24327,24327,24327,24327,24324,1533,24324,24327,24327,24327,24324,24324,24324,24324,24327,24327,24327,24324,24324,24327,24327,24324,24327,24327,24327,24327,24324,24327,24327,24324,24324,24327,24327,24324,24327,24327,24327,24327,24327,24327,24327,24324,24324,24327,24327,24327,24324,24324,24324,24324,24327,24327,24327,24324,24324,24327,24327,24327,24327,24327,24327,24327,24324,24327,24327,24324,24324,24327,24327,24324,24327,24327,24327,24327,24324,24327,24327,24324,1533,24324,24327,24327,24324,24324,24324,24324,24327,24327,24324,1533,1533,1533,24324,24327,24327,24327,24327,24327,24327,24324,1533,1533,1533,1533,1533,24324,24324,24324,24324,24324,24324,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,
};

// Sprite of Heart
const uint16_t heart[]=
{
	1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,0,0,1533,1533,1533,0,0,1533,1533,1533,1533,0,6784,6784,0,1533,0,6784,6784,0,1533,1533,0,6784,24539,31974,6784,0,6784,31974,24539,6784,0,1533,0,6784,24539,31974,57293,6784,57293,31974,24539,6784,0,1533,0,6784,24539,57293,57293,57293,57293,57293,24539,6784,0,1533,1533,0,6784,24539,57293,57293,57293,24539,6784,0,1533,1533,1533,1533,0,6784,24539,57293,24539,6784,0,1533,1533,1533,1533,1533,1533,0,6784,24539,6784,0,1533,1533,1533,1533,1533,1533,1533,1533,0,6784,0,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,0,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,
};

// Welcome sign for Welcome page
const uint16_t welcome[]=
{
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,40868,40868,0,0,40868,40868,40868,40868,0,0,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,40868,40868,40868,40868,0,0,40868,40868,0,0,40868,40868,40868,40868,0,0,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,0,0,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,0,0,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40868,40868,40868,40868,0,0,0,0,0,0,0,0,0,0,0,0,
};

// Crown Sprite for Welcome Page
const uint16_t crown[]=
{
	0,0,0,0,0,0,0,59722,59722,0,0,0,0,0,0,0,0,0,0,0,0,59722,59722,0,0,0,0,0,0,0,0,59722,59722,0,0,0,59722,8128,65535,59722,0,0,0,0,0,0,0,0,0,0,59722,8128,65535,59722,0,0,0,59722,59722,0,59722,8128,65535,59722,0,0,59722,8128,8128,59722,0,0,0,0,59722,59722,0,0,0,0,59722,8128,8128,59722,0,0,59722,8128,65535,59722,59722,8128,8128,59722,0,0,0,59722,59722,0,0,0,0,59722,8128,65535,59722,0,0,0,0,59722,59722,0,0,0,59722,8128,8128,59722,0,59722,59722,0,0,0,59722,24327,16142,59722,0,0,0,59722,8128,8128,59722,0,0,0,59722,24327,16142,59722,0,0,0,59722,59722,0,0,59722,24327,59722,0,0,59722,24327,16142,59722,0,0,0,0,59722,59722,0,0,0,0,59722,24327,16142,59722,0,0,59722,16142,59722,0,0,59722,24327,59722,0,59722,24327,24327,24327,16142,59722,0,0,59722,24327,24327,59722,0,0,59722,24327,24327,24327,16142,59722,0,59722,16142,59722,0,0,59722,24327,24327,59722,24327,24327,24327,24327,24327,16142,59722,0,59722,24327,24327,59722,0,59722,24327,24327,24327,24327,24327,16142,59722,24327,16142,59722,0,0,59722,24327,24327,59722,16142,24327,24327,24327,24327,24327,16142,59722,24327,24327,24327,24327,59722,16142,24327,24327,24327,24327,24327,16142,59722,24327,16142,59722,0,0,59722,24327,24327,24327,59722,16142,24327,24327,24327,16142,59722,24327,24327,24327,24327,24327,24327,59722,16142,24327,24327,24327,16142,59722,24327,24327,16142,59722,0,0,59722,24327,24327,24327,24327,59722,59722,59722,59722,59722,24327,24327,24327,24327,24327,24327,24327,24327,59722,59722,59722,59722,59722,24327,24327,24327,16142,59722,0,0,59722,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,16142,59722,0,0,59722,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,16142,59722,0,0,59722,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,0,0,16142,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,16142,59722,0,0,59722,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,0,8128,65535,0,16142,24327,24327,24327,24327,24327,24327,24327,24327,24327,16142,59722,0,0,59722,24327,24327,24327,24327,0,0,16142,24327,24327,24327,0,8128,8128,8128,65535,0,16142,24327,24327,24327,0,0,16142,24327,24327,16142,59722,0,0,59722,24327,24327,24327,0,8128,65535,0,16142,24327,24327,0,8128,8128,8128,8128,0,16142,24327,24327,0,8128,65535,0,16142,24327,16142,59722,0,0,59722,24327,24327,24327,0,8128,8128,0,16142,24327,24327,0,8128,8128,8128,8128,0,16142,24327,24327,0,8128,8128,0,16142,24327,16142,59722,0,0,59722,24327,24327,24327,24327,0,0,16142,24327,24327,24327,24327,0,8128,8128,0,16142,24327,24327,24327,24327,0,0,16142,24327,24327,16142,59722,0,0,0,59722,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,0,0,16142,24327,24327,24327,24327,24327,24327,24327,24327,16142,16142,59722,0,0,0,0,0,59722,59722,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,24327,16142,16142,16142,16142,16142,16142,59722,59722,0,0,0,0,0,0,0,0,59722,59722,59722,59722,59722,59722,59722,59722,59722,59722,59722,59722,59722,59722,59722,59722,59722,59722,59722,59722,0,0,0,0,0,
};

// Sprite for Grass
const uint16_t grass[]=
{
	26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,40224,40224,26901,26901,26901,33314,33314,26901,26901,26901,26901,33314,33314,26901,26901,26901,26901,26901,40224,40224,26901,26901,26901,33314,33314,26901,26901,26901,26901,33314,33314,26901,26901,26901,40224,40224,24327,24327,40224,40224,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,40224,40224,24327,24327,40224,40224,26901,26901,26901,26901,21138,21138,26901,26901,33314,26901,26901,26901,26901,26901,40224,40224,26901,26901,26901,26901,26901,26901,21138,21138,26901,26901,26901,26901,26901,26901,26901,26901,40224,40224,26901,26901,26901,26901,21138,21138,24327,24327,21138,21138,26901,26901,26901,26901,26901,26901,26901,26901,33314,33314,26901,26901,21138,21138,24327,24327,21138,21138,26901,26901,26901,26901,26901,26901,26901,26901,33314,33314,26901,26901,26901,26901,21138,21138,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,21138,21138,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,26901,
};

// Sprite for heart animation (flash)
const uint16_t heart_flash[]=
{
	1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,0,0,1533,1533,1533,0,0,1533,1533,1533,1533,0,24539,31974,0,1533,0,31974,24539,0,1533,1533,1533,0,24539,31974,57293,0,57293,31974,24539,0,1533,1533,1533,0,24539,57293,57293,57293,57293,57293,24539,0,1533,1533,1533,1533,0,24539,57293,57293,57293,24539,0,1533,1533,1533,1533,1533,1533,0,24539,57293,24539,0,1533,1533,1533,1533,1533,1533,1533,1533,0,24539,0,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,0,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,1533,
};

// Game Over sign for game over page
const uint16_t game[] =
{
	0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,0,0,0,0,0,0,0,0,0,0,0,0,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,0,0,0,0,0,0,0,0,0,0,0,0,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,0,0,0,0,0,0,0,0,57339,57339,0,0,0,0,0,0,57339,57339,0,0,0,0,0,0,0,0,0,0,0,0,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,0,0,0,0,0,0,0,0,57339,57339,0,0,0,0,0,0,57339,57339,0,0,0,0,0,0,0,0,0,0,0,0,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,
};

const uint16_t over[] =
{
	0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,0,0,0,0,0,0,0,0,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,0,0,0,0,0,0,0,0,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,0,0,0,0,57339,57339,57339,57339,0,0,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,0,0,57339,57339,57339,57339,0,0,0,0,0,0,0,0,0,0,0,0,57339,57339,57339,57339,57339,57339,57339,57339,0,0,0,0,0,0,57339,57339,0,0,0,0,57339,57339,57339,57339
};

// Tune notes for the song
uint32_t tune_notes[] = {   CS6_Db6, D6, FS5_Gb5, A5, FS5_Gb5, CS6_Db6, FS5_Gb5, A5, FS5_Gb5,    
							CS6_Db6, FS5_Gb5, A5, CS6_Db6, FS5_Gb5, A5, CS6_Db6,
							D6, G5, B5, G5, D6, G5, B5, G5,     
							D6, G5, B5, D6, G5, B5, D6,
							CS6_Db6, D6, FS5_Gb5, A5, FS5_Gb5, CS6_Db6, FS5_Gb5, A5, FS5_Gb5,    
							CS6_Db6, FS5_Gb5, A5, CS6_Db6, FS5_Gb5, A5, CS6_Db6,
							D6, G5, B5, G5, D6, G5, B5, G5,     
							D6, G5, B5, D6, B5, G5, B5,};


// Durations of each note playing in the song
uint32_t tune_times[] = {	28, 160, 188, 188, 188, 188, 188, 188, 188, 
							188, 188, 188, 376, 188, 188, 188,
							188, 188, 188, 188, 188, 188, 188, 188,
							188, 188, 188, 376, 188, 188, 188,
							28, 160, 188, 188, 188, 188, 188, 188, 188,
							188, 188, 188, 376, 188, 188, 188, 
							188, 188, 188, 188, 188, 188, 188, 188, 
							188, 188, 188, 376, 188, 188, 188,};

// Notes for game over sound
uint32_t gameover_sound[] = {B4, AS4_Bb4, A4, GS4_Ab4,};

// Durations of each note of game over
uint32_t gameover_times[] = {600, 600, 600, 3000,};


int main()
{
	srand(time(NULL)); // Seed the random number generator against time so that random numbers are generated each time the game is played

	// Movement of Princess character
	int hinverted = 0;
	int toggle = 0;
	int hmoved = 0;
	uint16_t x = 50;
	uint16_t y = 50;
	uint16_t oldx = x;
	uint16_t oldy = y;

	// Visibility of coin
	int coinVisible = 0;
	
	// Serial remote control connection
	char key = '\0';
	int keyPressed = 0;

	// Calling on set up functions
	initClock();
	initSysTick();
	setupIO();
	initSound();
    initSerial();
	mainmenu();
	background();
	
	gameStarted = true;

	livescore(lives);// Turn all LEDs on at start of game

	uint16_t ob1y = 20; 
	uint16_t ob1x = rand() % max;
	int delete = 0;

	while(1) // While loop for main game logic
	{
		if (gameStarted)
		{
			if (dataAvailable())// Checks if data is available so that the game isn't constantly waiting for input which would cause extreme delays in the game
			{
				key = egetchar();
				keyPressed = 1;
			}
			else
			{
				key = '\0';
				keyPressed = 0;
			}

			switch (key) 
			{
				case 'a': // Moves character left
					if (x > 0) 
					{
						x = x - 1;
						hmoved = 1;
						hinverted = 1; // Potentially for character flipping
					}

					break;

				case 'd': // Moves character right
					if (x < 112) 
					{
						x = x + 1;
						hmoved = 1;
						hinverted = 0; // Potentially for character flipping
					}

					break;
			}

			if (!keyPressed)// Prevents character from being moved when a key isn't pressed
			{
				hmoved = 0;
			}

			if ((hmoved))// If statement to place the princess on screen and move her left and right
			{
				// Redrawing to reduce flicker as there has been movement
				fillRectangle(oldx,oldy,12,16,RGBToWord( 47, 176, 255 ));// Background of the princess
				oldx = x;
				oldy = y;	
							
				if (hmoved)
				{
					if (toggle)
					{
						// Princess Standing
						putImage(x,104,12,16,princess,hinverted,0);
					}
					else
					{
						// Princess Walking
						putImage(x,104,12,16,princessWalk,hinverted,0);

					}// End if

					toggle = toggle ^ 1;

				}// End if

			}// End If

			if (coinVisible == 0)// Check if the coin is not currently visible
			{
				ob1y = 20; 
				delete = 0; // Reset delete flag to 0
				ob1x = rand() % max;// Set the x-coordinate of the coin to a random value between 0 and max (116)
				coinVisible = 1;// Set coinVisible flag to 1 to indicate that the coin is now visible

			}// End if

			if(ob1y != 104 && ob1x > 0)// If the coin is not at the bottom and still on the screen
			{
				fillRectangle(ob1x, ob1y, 12, 16, RGBToWord(47, 176, 255));
				ob1y++;// Move coin downwards (make it fall)
				putImage(ob1x, ob1y, 12, 16, coin, 0, 0);// new position of coin

				if (ob1y < 20)// If the coin is still partly above the screen
				{
					fillRectangle(ob1x, ob1y, 12, 16, RGBToWord(47, 176, 255));// clear image of coin

				}// End if
				
				delay(30);// delay for smooth animation

				if(isInside(ob1x, ob1y, 12, 16, x, 104) || isInside(ob1x, ob1y, 12, 16, x+12, 104) || isInside(ob1x, ob1y, 12, 16, x, 120) || isInside(ob1x, ob1y, 12, 16, x+12, 120))// Checks if any of the princess and coin coordinates touch (collision)
				{
					clearImage(ob1x, ob1y, 12, 16); // Will get rid of coin
					putImage(x,104,12,16,princess,hinverted,0); // Will reput princess incase she is erased
					score++; // Increase score
					printNumber(score,5,5,RGBToWord(0, 0, 0),RGBToWord( 47, 176, 255 ));// Updates score counter on screen
					ob1y = 20; // Reset coin height
					ob1x = rand() % max; // Put x coordinate at random value between 0-116
					coinVisible = 0;// reset coinVisible back to 0 as it's no longer visible

				}// End if

				if (ob1y >= 104 && delete == 0)// If the coin reaches the bottom and has not been deleted yet
				{
					clearImage(ob1x, ob1y, 12, 16);
					delete++;// increment delete flag
					lives--;// decerement lives
					livescore(lives);// Turn off an LED and perform heart "beating" animation
					coinVisible = 0;// Coin no longer visible

				}// End if
		
			}// End if
		
			if(countdown_seconds == 0)// When timer reaches 0
			{
				delay(500);
				tune_playing = 0; // Turn off background music
				playTune(gameover_sound,gameover_times,4,0);// Play game over sound
				gameOver();// display game over page

			}// End if

		}// End if

	}// End while

	delay(50);

	return 0;

}// End main()

void restart()// Function to restart game
{
	NVIC_SystemReset();

}// End restart()

void mainmenu(void)// Main menu function
{
	gameStarted = false;

	clear();// Filling the background in black
	putImage(0,24,128,42,welcome,0,0);
	putImage(78,18,30,22,crown,0,0);
	printText("to Royal Riches!", 10, 70, RGBToWord(246,143,160), RGBToWord(0, 0, 0));
	printText("Please press LEFT", 5, 110, RGBToWord(153, 0, 255), RGBToWord(0, 0, 0));
    printText("button to begin!", 10, 120, RGBToWord(153, 0, 255), RGBToWord(0, 0, 0));

	do
	{
		if(LeftPressed())// If the user presses the right button
		{
			clear();// Clear the main menu and enter the game
			gameStarted = true;
		}

	} while (LeftNotPressed());// End do while

}// End mainmenu()

void background(void)// Background creation function
{
	// Background Creation
	fillRectangle(0,0,128,160,RGBToWord( 76, 187, 23 ));// to change background colour grass
	fillRectangle(0,0,128,120,RGBToWord( 47, 176, 255 ));//to change sky
	putImage(5,125,18,11,grass,0,0);
	putImage(20,143,18,11,grass,0,0);
	putImage(52,130,18,11,grass,0,0);
	putImage(110,149,18,11,grass,0,0);
	putImage(100,125,18,11,grass,0,0);

	// Placing the heart images on screen for lives
	putImage(115,0,12,16,heart,0,0);
	putImage(100,0,12,16,heart,0,0);
	putImage(85,0,12,16,heart,0,0);

	// Placing score counter on screen
	printNumber(score,5,5,RGBToWord(0, 0, 0),RGBToWord( 47, 176, 255 ));

	// Play background music
	playTune(tune_notes, tune_times, tune_length, 0);

}// End background()

void livescore(int lives)// Function for Lives/Score and LED interaction
{
	if (lives == 3) 
	{
		// Turn on all LEDs
        redOn();
        red2On();
        red3On();
	}

	else if(lives == 2)
	{
		// Turn first LED off
		redOff();
		red2On();
		red3On();

		// Code to clear the heart & make the heart flash before disappearing 
		for (int i = 0; i < 3; i++) 
		{
			// Display the image
			putImage(85, 0, 12, 16, heart, 0, 0); // Adjust parameters accordingly
			
			// Delay for a short duration
			delay(100); // Adjust delay for flicker speed

			putImage(85, 0, 12, 16, heart_flash, 0, 0);

			// Delay for a short duration before flickering again
			delay(100); // Adjust delay for flicker speed
    	}

		clearImage(85, 0, 12, 16); // Clear image of heart to indicate to player that life was lost
	}

	else if(lives == 1)
	{
		// Keep last LED on
		redOff();
		red2Off();
		red3On();

	
		// Code to clear the heart & make the heart flash before disappearing 
		for (int i = 0; i < 3; i++) 
		{
			// Display the image
			putImage(100, 0, 12, 16, heart, 0, 0); // Adjust parameters accordingly
			
			// Delay for a short duration
			delay(100); // Adjust delay for flicker speed

			putImage(100, 0, 12, 16, heart_flash, 0, 0);

			// Delay for a short duration before flickering again
			delay(100); // Adjust delay for flicker speed
    	}

		clearImage(100, 0, 12, 16);
	}
	
	else if(lives == 0)
	{
		// Turn all LEDs off
		redOff();
		red2Off();
		red3Off();

		// Code to clear the heart & make the heart flash before disappearing 
		for (int i = 0; i < 3; i++) 
		{
			// Display the image
			putImage(115, 0, 12, 16, heart, 0, 0); // Adjust parameters accordingly
			
			// Delay for a short duration
			delay(100); // Adjust delay for flicker speed

			putImage(115, 0, 12, 16, heart_flash, 0, 0);

			// Delay for a short duration before flickering again
			delay(100); // Adjust delay for flicker speed
    	}
		clearImage(115, 0, 12, 16);

		// If you have no lives left, game over page shows up
		delay(500);
		tune_playing = 0; // Turn off background music
		playTune(gameover_sound,gameover_times,4,0); // Play game over sound
		gameOver();// Display game over page

	}// End If

}// End livescore()

void gameOverFlash(void)// Function to make LEDs flash when game is over
{
	// Make lights flash by turning all of them on then delay, then turn all off (3 times)
	for (int i = 0; i < 3; i ++)
	{
		// Turn all LEDs on
		redOn();
		red2On();
		red3On();

		delay(500);

		// Turn all LEDs off
		redOff();
		red2Off();
		red3Off();

		delay(500);

	}// End for

}// End gameOverFlash()

void gameOver(void)// Game over function
{
	gameStarted = false;
	gameOverFlash();// Make LEDs flash
	
	clear();// Filling the background in black
	putImage(2,20,68,20,game,0,0);
	putImage(56,50,62,20,over,0,0);
	putImage(82,18,30,22,crown,0,0);
	printText("Your score is: ", 17, 90, RGBToWord(153, 0, 255), RGBToWord(0, 0, 0));
	printNumber(score, 50, 115, RGBToWord(255, 255, 255), RGBToWord(0, 0, 0) ); // Prints score
	printText("Please press RIGHT ", 1, 135, RGBToWord(153, 0, 255), RGBToWord(0, 0, 0));// Prints press the right button to restart
	printText(" to restart!", 16, 145, RGBToWord(153, 0, 255), RGBToWord(0, 0, 0));// Prints press the right button to restart
	

	// If the user presses the right button restart the game
	do
	{
		if(RightPressed())
		{
			restart();
			break;
		}

	}while(RightNotPressed);// End do while
	
}// End of gameOver()

void initSysTick(void)// This function initializes the SysTick timer with a reload value of 48000, configures it to generate interrupts, sets an initial value for the timer, and enables interrupts globally.
{

	// This sets the reload value of the SysTick timer to 48000. The SysTick timer will count down from this value to zero, generating periodic interrupts.
	SysTick->LOAD = 48000;
	// This sets the control register for the SysTick timer
	SysTick->CTRL = 7;
	// This sets the current value of the SysTick timer. sometimes used as an offset to control when the SysTick interrupt will occur after the timer is enabled
	SysTick->VAL = 10;
	// The cpsie i instruction is an ARM Cortex-M assembly instruction that sets the I-bit in the CPSR (Current Program Status Register), enabling interrupts.
	__asm(" cpsie i "); // Enable interrupts globally

}// End of initSysTick()

void SysTick_Handler(void)// The function is designed to handle SysTick interrupts, update the state of a musical tune being played, and increment a milliseconds counter.
{
	if (tune_playing)// Checks whether a tune is currently playing and executes the code if there is
    {
		// Decrements the variable that represents the time remaining for the current note in the tune 
        tune_time_remaining --;

        if (tune_time_remaining <= 0)// If the tune_time_remaining <= 0 it means the current note duration has finished
        {
			// Incrementing to move onto next note
            tune_index ++;

            if (tune_index >= tune_length)// Checking if tune_index has reached the end of the tune
            {
                tune_index = 0;// Wraps around to the beginning of the tune 

            }// End inner if

            tune_time_remaining = note_times[tune_index];//update tune_time_remaining with the duration of the new current note
            playNote(notes[tune_index]);//calling the playnote function with the notes to play the note

        }// End inner if
        
    }// End If

	// Incrementing to represent the elapsed time in milliseconds
	milliseconds++;

	// Implementation of a countdown timer for the game as long as the seconds are >= 0 , 1 second has elapsed (milliseconds % 1000), and the flag for game starting is true
	if (gameStarted && milliseconds % 1000 == 0 && countdown_seconds >= 0 )
    {
		countdown_seconds--;
        printTime(0, countdown_seconds, 50, 150, RGBToWord(0, 0, 0), RGBToWord(76, 187, 23));// Function to print time onto the screen
    }

}// End of SysTick_Handler()


void initClock(void)// This function initializes the clock system by configuring the PLL to generate a clock signal with a specific multiplier
{
// This is potentially a dangerous function as it could
// result in a system with an invalid clock signal - result: a stuck system
        // Set the PLL up
        // First ensure PLL is disabled
        RCC->CR &= ~(1u<<24);// Clear the PLL enable bit (bit 24) in the RCC (Reset and Clock Control) control register 
        while( (RCC->CR & (1 <<25))); // Wait for PLL ready to be cleared
        
// Warning here: if system clock is greater than 24MHz then wait-state(s) need to be
// inserted into Flash memory interface

		// Set the latency for the Flash memory interface to one wait state		
        FLASH->ACR |= (1 << 0);
        FLASH->ACR &=~((1u << 2) | (1u<<1));
        // Turn on FLASH prefetch buffer
        FLASH->ACR |= (1 << 4);
        // Set PLL multiplier to 12 (yielding 48MHz)
        RCC->CFGR &= ~((1u<<21) | (1u<<20) | (1u<<19) | (1u<<18));
        RCC->CFGR |= ((1<<21) | (1<<19) ); 

        // Need to limit ADC (Analog-to-Digital Converter) clock to below 14MHz so will change ADC prescaler to 4
        RCC->CFGR |= (1<<14);

        // and turn the PLL (Phase-Locked Loop) back on again
        RCC->CR |= (1<<24);  

        // Set PLL as system clock source 
        RCC->CFGR |= (1<<1);

}// End of initClock()

void delay(volatile uint32_t dly)// Function that causes the program to pause execution for a specified amount of time.
{
	uint32_t end_time = dly + milliseconds;// Calculates the end time by adding the specified delay (dly) to the current value of the volatile variable milliseconds

	while(milliseconds != end_time)// This creates a loop that continuously checks if the current value of milliseconds is equal to the calculated end_time
		__asm(" wfi "); // Sleep

	// wfi = wait for interrupt

}// End of delay()

void enablePullUp(GPIO_TypeDef *Port, uint32_t BitNumber)// This function is designed to enable the pull-up resistor for a specific GPIO pin
{
	// This line clears the bits responsible for configuring the pull-up or pull-down resistors for the specified GPIO pin. It uses bitwise operations to clear the relevant bits.
	Port->PUPDR = Port->PUPDR &~(3u << BitNumber*2); // clear pull-up resistor bits
	// This line sets the specific bit in the GPIO configuration register to enable the pull-up resistor for the specified GPIO pin. It uses bitwise operations to set the relevant bit.
	Port->PUPDR = Port->PUPDR | (1u << BitNumber*2); // set pull-up bit

}// End of enablePullUp()

void pinMode(GPIO_TypeDef *Port, uint32_t BitNumber, uint32_t Mode)// This function is responsible for setting the mode of a specific GPIO pin on a microcontroller
{
	// This line reads the current value of the MODER register for the specified GPIO port and stores it in the mode_value varible
	uint32_t mode_value = Port->MODER;
	// This line left-shifts the Mode value by 2 positions . this is done to prepare the Mode value to be inserted into the appropriate bit positions in the 'mode_value'
	Mode = Mode << (2 * BitNumber);
	// This line clears the two bits responsible for configuring the mode of the specified GPIO pin. It uses bitwise operations to perform the clear operation.
	mode_value = mode_value & ~(3u << (BitNumber * 2));
	// This line sets the two bits for the specified GPIO pin with the new mode value. It uses bitwise operations to perform the set operation.
	mode_value = mode_value | Mode;
	// This line writes the modified mode_value back to the MODER register for the specified GPIO port, th
	Port->MODER = mode_value;

}// End of pinMode()

int isInside(uint16_t x1, uint16_t y1, uint16_t w, uint16_t h, uint16_t px, uint16_t py)// This function provides a  to check if a given point is inside a rectangle
{
	// Checks to see if point px,py is within the rectange defined by x,y,w,h
	uint16_t x2,y2;
	x2 = x1+w;// Calculates the x-coordinate of the bottom-right corner of the rectangle
	y2 = y1+h;// Calculates the y-coordinate of the bottom-right corner of the rectangle
	int rvalue = 0;

	if ( (px >= x1) && (px <= x2))// Checks if the x-coordinate of the point is greater than or equal to the left edge of the rectangle (x1) and less than or equal to the right edge of the rectangle (x2)
	{
		// ok, x constraint met
		if ( (py >= y1) && (py <= y2))// Checks if the y-coordinate of the point is greater than or equal to the top edge of the rectangle (y1) and less than or equal to the bottom edge of the rectangle (y2)
			rvalue = 1;

	}// End if

	// Function returns the value indicating whether the point (px, py) is inside the specified rectangle
	return rvalue;

}// End of isInside()

void setupIO()// This function is configuring the microcontroller's GPIO pins for input mode
{
	RCC->AHBENR |= (1 << 18) + (1 << 22);
	// RCC // enable Ports B and F . RCC (Reset and Clock Control) register is being modified to enable the clock for these specific ports.
	display_begin();// Responsible for initializing a display or some other output device
	pinMode(GPIOB,4,0);// Configures pin 4 of GPIOB as an input.
	pinMode(GPIOB,5,0);// Configures pin 5 of GPIOB as an input.
	
	pinMode(GPIOB,0,1); // Make GPIOB bit 0 an output
    pinMode(GPIOF,0,1); // Make GPIOF bit 0  an output
    pinMode(GPIOB,3,1); // Make GPIOB bit 3 an output

	enablePullUp(GPIOB,4);// Enables the pull-up resistor for pin 4 of GPIOB.
	enablePullUp(GPIOB,5);// Enables the pull-up resistor for pin 5 of GPIOB.
	
}// End of setupIO()

void playTune(uint32_t * the_notes, uint32_t * the_times, int length, int repeat)// Function for the background music of game
{
    notes = the_notes;
    tune_index = 0;
    note_times = the_times;
    tune_length = length;
    tune_repeat = repeat;
    tune_playing = 1;
    tune_time_remaining = note_times[0];

}// End playTune()

// Functions for Buttons
int RightPressed()
{
	if((GPIOB->IDR & (1 << 4))==0)// Checks if PB4 is cleared which indicates that right button is pressed
	{
		// Right button is pressed
		return 1;
	}
	else
	{
		// Right button is not pressed
		return 0;
	}

}// End RightPressed()

int RightNotPressed()
{
	if((GPIOB->IDR & (1 << 4))!=0)// Checks if PB4 is not cleared which indicates that right button is not pressed
	{
		// Right button is not pressed
		return 1;
	}
	else
	{
		// Right button is pressed
		return 0;
	}
	
}// End RightNotPressed()

int LeftPressed()
{
	if((GPIOB->IDR & (1 << 5))==0)// Checks if PB5 is cleared which indicates that left button is pressed
	{
		// Left button pressed
		return 1;
	}
	else
	{
		// Left button not pressed
		return 0;
	}

}// End LeftPressed()

int LeftNotPressed()
{
	if((GPIOB->IDR & (1 << 5))!=0)// Checks if PB5 is not cleared which indicates that left button is not pressed
	{
		// Left button not pressed
		return 1;
	}
	else
	{
		// Left button pressed
		return 0;
	}

}// End LeftNotPressed()

// Functions for LEDs
void redOn(void)
{
    GPIOB->ODR = GPIOB->ODR | (1 << 3); // PB3 on 
}

void redOff(void)
{
    GPIOB->ODR = GPIOB->ODR &  (0 << 3);// PB3 off
}

void red2On(void)
{
    GPIOB->ODR = GPIOB->ODR | (1 << 0);// PB0 on
}

void red2Off(void)
{
    GPIOB->ODR = GPIOB->ODR &  (0 << 0);// PB0 off
}

void red3On(void)
{
    GPIOF->ODR = GPIOF->ODR | (1 << 0);// PF0 on
}

void red3Off(void)
{
    GPIOF->ODR = GPIOF->ODR &  (0 << 0);// PF0 off
}

